# simple-windows-services-monitor

**Simple Windows Services Monitor (SWSM)** ‚Äî –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª—É–∂–±–∞–º–∏ Windows –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö. 
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä—ã —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º VPN, –≥–¥–µ SWSM –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º. 
–° –ø–æ–º–æ—â—å—é —Å–µ—Ä–≤–∏—Å–∞ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–ª—É–∂–±—ã –∏ –ø–æ–ª—É—á–∞—Ç—å –∏—Ö —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å.

–î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [WinRM](https://github.com/masterzen/winrm).

| [<img src="screenshots/screenshot_1.png" width="250"/>](screenshots/screenshot_1.png) | [<img src="screenshots/screenshot_2.png" width="250"/>](screenshots/screenshot_2.png) | [<img src="screenshots/screenshot_3.png" width="250"/>](screenshots/screenshot_2.png) |
|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤                                                                       | –î–µ—Ç–∞–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞                                                                       | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±—ã                                                                     |


## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîë –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT.
- üïπÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏ Windows (start, stop, restart).
- üì° –†–∞–±–æ—Ç–∞ —Å —É–¥–∞–ª—ë–Ω–Ω—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –ø–æ WinRM.
- üì¶ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL.
- üì¢ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–ª—É–∂–± –º–µ–∂–¥—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìª –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–ª—É–∂–± —Å —Å–µ—Ä–≤–µ—Ä–∞
- üìú –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- üóûÔ∏è –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.24+
- PostgreSQL 16+
- Windows Server —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º WinRM

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API
[–ö–æ–ª–ª–µ–∫—Ü–∏—è Postman](https://documenter.getpostman.com/view/26097853/2sB3HqHdhN)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WinRM –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

–ù–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º Windows-—Ö–æ—Å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å WinRM.  
–û—Ç–∫—Ä–æ–π—Ç–µ PowerShell **–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:

```powershell
winrm quickconfig
y
winrm set winrm/config/service/Auth '@{Basic="true"}'
winrm set winrm/config/service '@{AllowUnencrypted="true"}'
winrm set winrm/config/winrs '@{MaxMemoryPerShellMB="1024"}'
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

   ```bash
   git clone https://github.com/trsv-dev/simple-windows-services-monitor.git
   cd simple-windows-services-monitor
   ```
2. –°–æ–∑–¥–∞–π—Ç–µ –ë–î –≤ PostgreSQL:
    ```bash
   psql -h localhost -U postgres
   create database swsm;
   create user swsm with encrypted password 'userpassword';
   grant all privileges on database swsm to swsm;
   alter database swsm owner to swsm;
   ```

3. –°–æ–∑–¥–∞–π—Ç–µ –≤ –∫–æ—Ä–Ω–µ —Ñ–∞–π–ª `.env.development` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø—Ä–∏–º–µ—Ä –¥–∞–Ω –≤ env_example):
    ```env
    # SWSM init vars
    ####################################################################################
    DATABASE_URI=postgres://swsm:userpassword@localhost:5432/swsm?sslmode=disable
    RUN_ADDRESS=127.0.0.1:8080
    # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 5985 (http) –∏–ª–∏ 5986 (https) –ø–æ—Ä—Ç—ã
    WINRM_PORT=5985
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–≥ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ true –¥–ª—è HTTPS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å WinRM
    WINRM_USE_HTTPS=false
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–≥ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ true, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSL (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤).
    WINRM_INSECURE_FOR_HTTPS=false
    LOG_LEVEL=debug
    LOG_OUTPUT=./logs/swsm.log
    AES_KEY=your-base64-key
    SECRET_KEY=your-jwt-secret
    WEB_INTERFACE=true
    API_BASE_URL=http://localhost:8080/api
    # –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º –∫–ª—é—á–æ–º
    OPEN_REGISTRATION=false
    # –ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞—è (`OPEN_REGISTRATION=false`) - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–ª—é—á,
    # –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ç–æ—Ä—ã–π –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
    REGISTRATION_KEY=your-secret-registration-key
    
    # Postgres init vars (–¥–ª—è –æ–±—Ä–∞–∑–∞ postgres)
    ####################################################################################
    # —Ç–æ—Ç –∂–µ –ª–æ–≥–∏–Ω, —á—Ç–æ –≤ URI
    POSTGRES_USER=swsm
    # —Ç–æ—Ç –∂–µ –ø–∞—Ä–æ–ª—å, —á—Ç–æ –≤ URI
    POSTGRES_PASSWORD=userpassword
    # —Ç–æ –∂–µ –∏–º—è –ë–î, —á—Ç–æ –≤ URI
    POSTGRES_DB=swsm
   ```

4. –°–æ–±–µ—Ä–∏—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   cd ./cmd/swsm/
   go build -o "swsm"
   # –í –û–° Linux –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –Ω–∏–∂–µ —á—Ç–æ–±—ã
   # —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å RAW-—Å–æ–∫–µ—Ç–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è ICMP-–ø—Ä–æ–≤–µ—Ä–æ–∫) –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –æ—Ç root.
   # –í –û–° Windows —ç—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
   sudo setcap cap_net_raw=+ep ./swsm
   ./swsm
   ```
   –ë—ç–∫–µ–Ω–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∑–∞–ª–∏ –≤ `RUN_ADDRESS`, –Ω–∞–ø—Ä–∏–º–µ—Ä: http://127.0.0.1:8080


5. –ï—Å–ª–∏ –≤ `env` –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ `WEB_INTERFACE=true` (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∫–ª—é—á–µ–Ω) —Ç–æ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞—Ç–∏–∫–∏. 
–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ç–∞—Ç–∏–∫–∏:
   ```bash
   cd ../../static
   go build -o static-server
   ./static-server -port=3000 -dir=./
   ```
6. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://127.0.0.1:3000, API: http://127.0.0.1:8080/api
---

## –ó–∞–ø—É—Å–∫ –≤ docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/trsv-dev/simple-windows-services-monitor.git
   cd simple-windows-services-monitor
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –≤ –∫–æ—Ä–Ω–µ —Ñ–∞–π–ª `.env.production` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø—Ä–∏–º–µ—Ä –¥–∞–Ω –≤ env_example):
    ```env
    # SWSM init vars
    ####################################################################################
    DATABASE_URI=postgres://swsm:userpassword@db:5432/swsm?sslmode=disable
    RUN_ADDRESS=127.0.0.1:8080
    # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 5985 (http) –∏–ª–∏ 5986 (https) –ø–æ—Ä—Ç—ã
    WINRM_PORT=5985
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–≥ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ true –¥–ª—è HTTPS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å WinRM
    WINRM_USE_HTTPS=false
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–≥ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ true, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSL (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤).
    WINRM_INSECURE_FOR_HTTPS=false
    LOG_LEVEL=debug
    LOG_OUTPUT=./logs/swsm.log
    AES_KEY=your-base64-key
    SECRET_KEY=your-jwt-secret
    WEB_INTERFACE=true
    API_BASE_URL=/api
    # –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º –∫–ª—é—á–æ–º
    OPEN_REGISTRATION=false
    # –ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞—è (`OPEN_REGISTRATION=false`) - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–ª—é—á,
    # –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ç–æ—Ä—ã–π –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
    REGISTRATION_KEY=your-secret-registration-key
    
    # Postgres init vars (–¥–ª—è –æ–±—Ä–∞–∑–∞ postgres)
    ####################################################################################
    # —Ç–æ—Ç –∂–µ –ª–æ–≥–∏–Ω, —á—Ç–æ –≤ URI
    POSTGRES_USER=swsm
    # —Ç–æ—Ç –∂–µ –ø–∞—Ä–æ–ª—å, —á—Ç–æ –≤ URI
    POSTGRES_PASSWORD=userpassword
    # —Ç–æ –∂–µ –∏–º—è –ë–î, —á—Ç–æ –≤ URI
    POSTGRES_DB=swsm
   ```
3. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º (–≤ `env` –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ `WEB_INTERFACE=true`), 
—Ç–æ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω `docker-compose.yml`) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   docker compose --env-file .env.production --profile frontend up -d --build
   ```
   –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ API (–≤ `env` –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ `WEB_INTERFACE=false`),
   —Ç–æ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω `docker-compose.yml`) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   docker compose --env-file .env.production up -d --build
   ```
4. –§—Ä–æ–Ω—Ç–µ–Ω–¥ (–µ—Å–ª–∏ –ø–æ–¥–Ω—è—Ç): http://127.0.0.1/ (–ø–æ—Ä—Ç 80 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), API: http://127.0.0.1:8080/api

## –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Windows

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª **_create_user.ps1_**, —è–≤–ª—è—é—â–∏–π—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º PowerShell,
—Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä Windows —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è:
   - –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–ª—É–∂–±, –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è,
   - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–ª—É–∂–± –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ —Å–ª—É–∂–±–∞–º–∏,
   - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–ª—É–∂–± –∏ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–ª—É–∂–±–∞–º–∏ (–∫—Ä–æ–º–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ª—É–∂–±).

–¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª—É–∂–± —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –æ—Ç–∑—ã–≤ 
—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏, –∞ —Ç–∞–∫ –∂–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞ Windows Server, –æ—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, 
—É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–æ **_create_user.ps1_** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç, —Å–ª–µ–¥—É–π—Ç–µ —ç–∫—Ä–∞–Ω–Ω—ã–º –ø–æ–¥—Å–∫–∞–∑–∫–∞–º:
```bash
 PS C:\Users\SampleUser\Desktop> .\create_user.ps1
```
![screenshot_4.png](screenshots/screenshot_4.png)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, –±—É–∫–≤—ã + —Ü–∏—Ñ—Ä—ã + —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ -Force –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–≤–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö (!),
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ -DryRun –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω—ã–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º,
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ backup'—ã SDDL –∏–∑ %TEMP% –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç–∫–∞—Ç–∞.

<details>
<summary>
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
</summary>

**1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º:**
```powershell
.\create_user.ps1 -Mode Create -UserName readonly_user -Password "Pass456!" -ReadOnly
```   
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
   - —Å–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è _readonly_user_ —Å –¥–æ—Å—Ç—É–ø–æ–º —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–ª—É–∂–±,
   - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.

**2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
```powershell
.\create_user.ps1 -Mode GrantOnly -UserName existing_user -Services MSSQLSERVER,SQLSERVERAGENT
```   
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
   - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQL Server —Å–ª—É–∂–±–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–ª–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ —Å–ª—É–∂–±–∞–º–∏:**
```powershell
.\create_user.ps1 -Mode Create -UserName monitor_user -Password "SecurePass123!" -Services wuauserv,Spooler,W3SVC
```
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
   - —Å–æ–∑–¥–∞—ë—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è _monitor_user_,
   - –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –≥—Ä—É–ø–ø—ã: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ DCOM, –ß–∏—Ç–∞—Ç–µ–ª–∏ –∂—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π 
(Remote Management Users, DCOM Users, Event Log Readers),
   - –¥–∞—ë—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–ª—É–∂–±,
   - –î–∞—ë—Ç –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Start/Stop/Restart) —Å–ª—É–∂–±–∞–º–∏: Windows Update, –î–∏—Å–ø–µ—Ç—á–µ—Ä –ø–µ—á–∞—Ç–∏, IIS.

**4. –û—Ç–∑—ã–≤ –ø—Ä–∞–≤ –Ω–∞ —Å–ª—É–∂–±—ã:**
```powershell
.\create_user.ps1 -Mode Rollback -UserName monitor_user -Services wuauserv,Spooler
```
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
   - —É–¥–∞–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —Å–ª—É–∂–±–∞–º–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è _monitor_user_,
   - —É–±–∏—Ä–∞–µ—Ç ACE –∏–∑ SCM (Service Control Manager).

**5. –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```powershell
.\create_user.ps1 -Mode DeleteUser -UserName monitor_user
```
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
   - —É–¥–∞–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–∏—Å—Ç–µ–º—ã,
   - –æ—á–∏—â–∞–µ—Ç –ø—Ä–∞–≤–∞ –∏–∑ SCM –∏ WinRM,
   - —É–¥–∞–ª—è–µ—Ç –∏–∑ –≤—Å–µ—Ö –≥—Ä—É–ø–ø.

**6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

   **_-DryRun_** - —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
```powershell
 .\create_user.ps1 -Mode Create -UserName test_user -Password "Test123!" -Services W3SVC -DryRun 
```
   **_-Force_** - –æ–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ª—É–∂–±. –ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø!
–ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–ª—É–∂–±—ã (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ BSOD):

```powershell
.\create_user.ps1 -Mode Create -UserName admin -Password "P@ss!" -Services Dhcp -Force
```

**7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup:**

–ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π backup:
```powershell
Get-ChildItem $env:TEMP\*.SDDL.backup.*.txt | Sort-Object LastWriteTime -Descending
```
–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É:
```powershell
sc.exe sdset <ServiceName> (Get-Content "C:\Users\...\Temp\ServiceName.SDDL.backup.20260216_143012.txt" -Raw)
```
</details>
